# Comunicació

## Comunicació amb atributs

Els Web Components també es poden parametritzar mitjaçant atributs o propietats, a l'igual que els elements HTML comuns.

```js
class MissatgeBenvinguda extends HTMLElement {
    constructor() {
        super();
        this.attachShadow({ mode: 'open' });
    }

    connectedCallback() {
        const nom = this.getAttribute('nom') || 'Usuari';
        this.shadowRoot.innerHTML = `<h2>Hola, ${nom}!</h2>`;
    }
}

customElements.define('missatge-benvinguda', MissatgeBenvinguda);
```

Com veiem, aci la novetat està en la implementació de la funció `connectedCallback()`. Aquesta és una funció pròpia del **Cicle de Vida dels Web Components**.

Quan parlem del **cicle de vida dels Web Component** ens referim a una sèrie de mètodes especials que es s'invoquen automàticament en diferents moments del seu existència, i que permeten controlar què passa quan el component es crea, s’afig al DOM, s’actualitza o s’elimina.

Concretament, el mètode `ConnectedCallback()` s'invoca quan el component s'afig al DOM, de manera que en ell podem realitzar inicialitzacions com afegir esdeveniments, carregar dades de manera dinàmica o modificar el DOM del component.

Aleshores, dins d'aquest mètode, el que fem és obtenir el valor de l'atribut *nom* per assignar-lo a una propietat amb el mateix nom. Si aquest no s'especifica, pren *Usuari* com a valor predeterminat. I ja amb aquest valor establert, afig el contingut intern del Shadow DOM.

!!!note "Sobre el cicle de vida dels Web Components"

     Podem ressumir el cicle de vida dels Web Components i els corresponents callbacks en:
     
     * **Creació** (`constructor()`): Es defineix l'estructura i el Shadow DOM.
     * **Inserció al DOM** (`connectedCallback()`): Es poden inicialitzar dades o fer peticions.
     * **Modificació d'atributs** (`attributeChangedCallback()`): Es poden modificar les propietats del component en temps real.
     * **Eliminació del DOM** (`disconnectedCallback()`): Es netegen recursos o es cancel·len subscripcions.
     * **Moviment entre documents** (`adoptedCallback()`): Quan el component és mogut entre diferents documents; d'utilitat per a aplicacions que usen **iframes** o documents dinàmics.

Amb la definició del component anterior, la forma de proporcionar paràmetres serà:

```html
<missatge-benvinguda nom="Jose"></missatge-benvinguda>
```

!!! question "Activitat"
     Descarrega l'exemple [exemple1.zip](rsc/exemple1.zip) i descomprimeix-lo al teu ordinador. Una vegada fet:

     * Examina com s'organitzen els diferents fitxers.
     * Analitza tot el codi HTML i Javascript que apareix en ell.
     * Prova a executar-lo i intenta veure si funciona com esperaríes o no.
  
!!! question "Activitat 2"
     Partint de l'exemple de Web Component amb la targeta de productes, modifica-la per tal que puguem proporcionar-li com a atributs el nom del producte, la descripció i el preu, de la següent forma:

     ```html
     <producte-card nom="Pizza Margarita" preu="7€" descripcio="Pizza amb base fina de tomaca i formatge" ></producte-card>
     ```
     