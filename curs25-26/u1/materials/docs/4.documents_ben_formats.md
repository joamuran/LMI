---
# Informació general del document
title: 4. Elaboració de documents ben formats
subtitle: Llenguatges de marques i sistemes de gestió de la informació (LMSGI)
authors: 
    - José A. Múrcia Andrés
lang: ca
page-background: img/bg.png

# Portada
titlepage: true
titlepage-rule-height: 0
# titlepage-rule-color: AA0000
# titlepage-text-color: AA0000
titlepage-background: img/portada.png
# logo: img/logotext.png

# Taula de continguts
toc: true
toc-own-page: true
toc-title: Continguts

# Capçaleres i peus
header-left: Llenguatges de marques
header-right: Curs 2024-2025
footer-left: IES Jaume II El Just
footer-right: \thepage/\pageref{LastPage}

# Imatges
float-placement-figure: H
caption-justification: centering

# Llistats de codi
listings-no-page-break: false
listings-disable-line-numbers: false

header-includes:
     - \usepackage{lastpage}
---

# Introducció a XML

L'any 1989, Tim Berners-Lee, conegut com el pare de la *Web*, va crear el llenguatge HTML, per a l'intercanvi de documentació en el MIT (Institut Tecnològic de Massachusetts). Per a això es va basar en SGML (*Standard Generalized Markup Language*).

Posteriorment, la ***W3C*** (*World Wide Web Consortium*), un conjunt d'organitzacions per a l'estandarització de tot allò relacionat amb la web, el 1998, va crer el llenguatge ***XML*** (*eXtensible Markup Language*), com a una simplificació d'SGML, amb l'objectiu de facilitar la compatibilitat amb HTML i proporcionar una plataforma base per generar diferents llenguatges de marques.

## Característiques del Metallenguatge XML

Les característiques general d'XML són:

- **Descriptiu o Semàntic**: XML és un metallenguatge que estructura la informació en documents utilitzant etiquetes pròpies i una gramàtica determinada per la **DTD** (Document Type Definition).
- **Interoperabilitat**: XML permet la compartició de documents entre diferents sistemes operatius i aplicacions.
- **Estàndard Obert**: XML és lliure de llicències i optimitzat per a la web.
- **Estructura en Arbre**: Els documents XML tenen una estructura jeràrquica amb un únic element arrel.

## Marcat del Document

Els elements que componen un document, com en tot llenguatge de marques són;

- **Etiquetes**, que delimiten parts del text i es representen entre els caràcters `<` i `>`.
- **Elements**, compostos per una etiqueta d'obertura, un contingut i una etiqueta de tancament.
- **Atributs**, que afigen propietats als elements i es defineixen dins de les etiquetes d'obertura.

Veiem un exemple senzill de document XML:

```xml
  <?xml version="1.0" encoding="utf-8"?>
  <!DOCTYPE estudiant SYSTEM "http://www.example.com/estudiant.dtd">
  <estudiant>
    <nom>Paco</nom>
    <poblacio>Tavernes de la Valldigna</poblacio>
    <cicle>DAM</cicle>
  </estudiant>
```

També pots veure exemples més complets als documents [AndroidManifest.xml](recursos/AndroidManifest.xml) i [MainActivity.xml](recursos/MainActivity.xml) vistos anteriorment.

##  Parts d'un Document XML

Un document XML consta de les següents parts:

1. Un **Pròleg**, que inclou la declaració XML i la declaració de tipus de document:

   - **Declaració XML**: Indica que es tracta d'un document XML, la versió i la codificació del document.

     ```xml
     <?xml version="1.0" encoding="utf-8"?>
     ```

   - **Declaració de Tipus de Document (DOCTYPE)**: Defineix el tipus de document i pot incloure una referència a una definició del tipus de document o DTD (*Document Type Definition*) que especifica les regles per a la validació del document XML. És opcional i s’utilitza principalment per a documents que necessiten validació. Aquest pot indicar-se al mateix document, o en un lloc extern. En aquest últim cas, farem ús de la paraula `SYSTEM` per indicar-ho:

     ```xml
     <!DOCTYPE estudiant SYSTEM "http://www.example.com/estudiant.dtd">
     ```

2. El **cos del document** conté les dades o el text del document XML, estructurat en elements anidats (un dins d'altre).

      Les regles bàsiques que ha de complir aquest són:

      - Els elements han de tindre una estructura jeràrquica, és a dir, uns elements dins d'altres, anidats, en forma d'*arbre*.
      - Només pot haver-hi un element arrel (al principi de l'estructura).
      - Els elements han d'estar correctament anidats.
      - Els elements no es poden superposar, és a dir, que no podem tancar una etiqueta fins que no tanquem totes les que hem obert a dins.

## Què és un document XML ben format?

Un document XML es considera ben format quan compleix les següents regles sintàctiques definides per la W3C:

- **Pròleg**: Ha de tenir una declaració XML completa.
- **Element Arrel**: Només ha d'existir un únic element arrel que anide la resta d'elements.
- **Etiquetes**: Un element ha de començar i acabar amb la mateixa etiqueta.
- **Atributs**: Els valors dels atributs han d'anar entre cometes dobles ("") o simples ('').
- **Diferenciació entre Majúscules i Minúscules**: Cal tindre en compte que, **en XML, `<etiqueta>` no és el mateix que `<ETIQUETA>`**.

Veiem alguns exemples de documents XML que **no** estarien ben formats:

!!! alert "Exemple amb un error d'anidament"

    ```xml
    <?xml version="1.0" ?>
    <estudiant>
      <nom> Paco </nom>
      <poblacio> 
          <provincia> 
              Tavernes o València
          </poblacio>
      </provincia>
    </estudiant>
    ```

??? question "Com resoldries l'exemple anterior?"

    El document anterior és incorrecte perquè l’etiqueta `<provincia>` està tancada abans que l’etiqueta `<poblacio>`, la qual cosa no és vàlida en XML.

    Una solució sería:

      ```xml
      <?xml version="1.0" ?>
      <estudiant>
        <nom> Paco </nom>
        <poblacio> 
            <nom>
              Tavernes
            </nom>
            <provincia> 
                València
            </provincia>
        </poblacio>
      </estudiant>
      ```

      Podríem pensar també en la següent solució:

      ```xml
      <?xml version="1.0" ?>
      <estudiant>
        <nom> Paco </nom>
        <poblacio> 
              Tavernes
            <provincia> 
                València
            </provincia>
        </poblacio>
      </estudiant>
      ```

      La qual **no seria correcte segons les regles d'XML pur** (encar aque en HTML sí que s'accepten construccions similars). En XML, una etiqueta no pot tenir contingut de tipus text i altres etiquetes filles al mateix nivell. Així que, en aquest cas, no és vàlid tenir el text “Tavernes” i l’etiqueta `<provincia>` dins de `<poblacio>`.

!!! alert "Exemple amb múltiples arrels"

    ```xml
    <?xml version="1.0" ?>
    <estudiant>
      <nom> Paco </nom>
    </estudiant>
    <estudiant>
      <nom> Pepe </nom>
    </estudiant>
    ```

??? question "Com resoldries l'exemple anterior?"

    El document anterior és incorrecte conté dos elements arrel, concretament de tipus `<estudiant>`.

    És un cas que se'ns pot plantejar habitualment quan tenim una col·lecció d'elements iguals que volem representar en un document. La solució passa per afegir un element arrel únic (en aquest cas `<estudiants>`), que faça de de la col·lecció.

      ```xml
      <?xml version="1.0" ?>
      <estudiants>
        <estudiant>
          <nom> Paco </nom>
        </estudiant>
        <estudiant>
          <nom> Pepe </nom>
        </estudiant>
      </estudiants>
      ```

